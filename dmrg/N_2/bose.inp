define                  L               6
define                  N               2

define                  Nstat           1

define                  t               1.0
define 					U      			5.0
define 					omegai    		0.0
define 					omegaf    		0.5

define 					mu	    		0.007

define                  iu              sqrt(-1.0)
define                  pi              2.0*arg(iu)

define 					hop				+iu*t*exp(-2*pi*iu*omegai/L)
define 					hopc			-iu*t*exp(+2*pi*iu*omegai/L)

define                  sq2             sqrt(2)
define                  sq3             sqrt(3)

dmrg_states					0	0	80	80		0

memory					8000
show					memory

reflect_blocks                  false
reflect_universe                true 
halfsweep                       false

zips                                    20
zipinner                                6

sites                   L
show            hamiltonian             4


//..................................................................SPAZIO      DI      HILBERT

space   state0                          // 0
						states                  1
						quantum                 Num             0
						bose

space   state1                          // 1
						states                  1
						quantum                 Num             1
						bose

space   state2                          // 2
						states                  1
						quantum                 Num             2
						bose


//..................................................................OPERATORI

action  n
		0.      0.      0.
		0.      1.      0.
		0.      0.      2.

action  nm1
		-1.     0.      0.
		0.      0.      0.
		0.      0.      1.

action  bd
		0.      0.      0.
		1.      0.      0.
		0.      sq2     0.

action  b
		0.      1.      0.
		0.      0.      sq2
		0.      0.      0.

action  id
		1.      0.      0.
		0.      1.      0.
		0.      0.      1.		


//..................................................................HAMILTONIANA        STATICA

ham_begin       Sites

				do      i       0       Sites-1 1

						term    coeff	t*exp(-2*pi*iu*omegai/Sites)
								action  bd      i
								action  b       i+1

						term    coeff	t*exp(+2*pi*iu*omegai/Sites)
								action  bd      i+1
								action  b       i

						term    coeff           -U/2
								action  nm1     i
								action  n       i

				done

						term    coeff           mu
								action  n       0

ham_end

//.........................calcola i primi 20 autovalori della mat.den.srid

#renyi -20

//..................................................................TARGET


		do      len 2   L       2
				target  psi
						sites                           len
						states                          Nstat
						quantum         Num             N
		done

//..................................................................TIME_EVO

evolution		time
				time_zips				1
				timestep				0.1
				steps_number			25000
				target psi				0


//..................................................................CINETICA

	timeham_begin		Sites

				do      i       0       Sites-1 1

						term    coeff           t*exp(-2*pi*iu*omegaf/Sites)
								action  bd      i
								action  b       i+1

						term    coeff           t*exp(+2*pi*iu*omegaf/Sites)
								action  bd      i+1
								action  b       i

						term    coeff           -U/2
								action  nm1     i
								action  n       i

				done

						term    coeff           mu
								action  n       0

	timeham_end

//..................................................................Poperty_st


property	corr0	 sites 	L+1
	do 	i 	0 	L-2 	1

				term 	coeff   hop	
	
						action 	bd 	i
					 	action 	b 	i+1
	
				term 	coeff 	hopc	
	
						action 	bd 	i+1
					 	action 	b 	i

	done

				term 	coeff   hop	
	
						action 	bd 	L-1
					 	action 	b 	0
	
				term 	coeff 	hopc	
	
						action 	bd 	0
					 	action 	b 	L-1


property	corcor	 sites 	L+1

	do 	x 	0 	L-2 	1
	do  y 	0 	L-2 	1

				term 	coeff   hop*hop
				
						action 	bd 	x
					 	action 	b 	x+1
					 	action 	bd 	y
					 	action 	b 	y+1
								
				term 	coeff 	hop*hopc
				
						action 	bd 	x
					 	action 	b 	x+1
					 	action 	bd 	y+1
					 	action 	b 	y	
				
				term 	coeff 	hop*hopc
				
						action 	bd 	x+1
					 	action 	b 	x
					 	action 	bd 	y
					 	action 	b 	y+1

				term 	coeff 	hopc*hopc
				
						action 	bd 	x+1
					 	action 	b 	x
					 	action 	bd 	y+1
					 	action 	b 	y

	done
	done


	do  x 	0 	L-2 	1

				term 	coeff   hop*hop
				
						action 	bd 	x
					 	action 	b 	x+1
					 	action 	bd 	L-1
					 	action 	b 	0
								
				term 	coeff 	hop*hopc
				
						action 	bd 	x
					 	action 	b 	x+1
					 	action 	bd 	0
					 	action 	b 	L-1	
				
				term 	coeff 	hop*hopc
				
						action 	bd 	x+1
					 	action 	b 	x
					 	action 	bd 	L-1
					 	action 	b 	0

				term 	coeff 	hopc*hopc
				
						action 	bd 	x+1
					 	action 	b 	x
					 	action 	bd 	0
					 	action 	b 	L-1

	done

	do  y 	0 	L-2 	1

				term 	coeff   hop*hop
				
						action 	bd 	L-1
					 	action 	b 	0
					 	action 	bd 	y
					 	action 	b 	y+1
								
				term 	coeff 	hop*hopc
				
						action 	bd 	L-1
					 	action 	b 	0
					 	action 	bd 	y+1
					 	action 	b 	y	
				
				term 	coeff 	hop*hopc
				
						action 	bd 	0
					 	action 	b 	L-1
					 	action 	bd 	y
					 	action 	b 	y+1

				term 	coeff 	hopc*hopc
				
						action 	bd 	0
					 	action 	b 	L-1
					 	action 	bd 	y+1
					 	action 	b 	y

	done

				term 	coeff   hop*hop
				
						action 	bd 	L-1
					 	action 	b 	0
					 	action 	bd 	L-1
					 	action 	b 	0
								
				term 	coeff 	hop*hopc
				
						action 	bd 	L-1
					 	action 	b 	0
					 	action 	bd 	0
					 	action 	b 	L-1	
				
				term 	coeff 	hop*hopc
				
						action 	bd 	0
					 	action 	b 	L-1
					 	action 	bd  L-1
					 	action 	b 	0

				term 	coeff 	hopc*hopc
				
						action 	bd 	0
					 	action 	b 	L-1
					 	action 	bd 	0
					 	action 	b 	L-1


end


